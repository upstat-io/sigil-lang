[package]
name = "ori_llvm"
version = "0.1.0-alpha.6"
edition = "2021"
description = "LLVM backend for the Ori compiler"
license = "MIT OR Apache-2.0"
repository = "https://github.com/upstat-io/ori-lang"

# This crate is EXCLUDED from the main workspace because it requires LLVM.
# Build only in container: ./docker/llvm/run.sh cargo build -p ori_llvm

[dependencies]
# LLVM bindings
# Note: force-dynamic required for Linux/macOS. Windows doesn't support dynamic LLVM
# linking in llvm-sys, so Windows builds are marked continue-on-error until we
# set up a proper static LLVM build with all targets.
inkwell = { version = "0.8", features = ["llvm17-0-force-dynamic"] }

# Ori crates (relative paths since excluded from workspace)
ori_ir = { path = "../ori_ir" }
ori_types = { path = "../ori_types" }

# Debug instrumentation
tracing = "0.1"
tracing-subscriber = { version = "0.3", features = ["env-filter"] }

# Concurrency primitives
parking_lot = "0.12"

[dev-dependencies]
pretty_assertions = "1.4"

[lints.rust]
unsafe_code = "deny"

[lints.clippy]
all = { level = "warn", priority = -1 }
pedantic = { level = "warn", priority = -1 }
# Allow for LLVM FFI work
missing_errors_doc = "allow"
missing_panics_doc = "allow"
module_name_repetitions = "allow"
must_use_candidate = "allow"
