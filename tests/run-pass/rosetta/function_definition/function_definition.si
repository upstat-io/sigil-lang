// Rosetta Code: Function definition
// Task: Demonstrate how to define functions
// Sigil uses @name (params) -> return_type = expression

// Simple function with no parameters
@greeting () -> str = "Hello, World!"

// Function with one parameter
@square (n: int) -> int = n * n

// Function with multiple parameters
@add (a: int, b: int) -> int = a + b

// Function with different types
@repeat_string (s: str, n: int) -> str =
    if n <= 0 :then ""
    :else s + repeat_string(s, n - 1)

// Function returning a list
@range_list (start: int, end: int) -> [int] =
    collect(start..end, x -> x)

// Function with boolean return
@is_even (n: int) -> bool = n % 2 == 0

// Function using other functions (composition)
@sum_of_squares (a: int, b: int) -> int = add(square(a), square(b))

// Recursive function
@factorial (n: int) -> int = recurse(
    .cond: n <= 1,
    .base: 1,
    .step: n * self(n - 1)
)

// Function with pattern matching body
@fizzbuzz (n: int) -> str = match(
    n % 15 == 0 : "FizzBuzz",
    n % 3 == 0 : "Fizz",
    n % 5 == 0 : "Buzz",
    str(n)
)

// Function taking a function as parameter (via lambda)
@apply_twice (f: int -> int, x: int) -> int = f(f(x))

@main () -> void = run(
    print(greeting()),
    print("square(5) = " + str(square(5))),
    print("add(3, 4) = " + str(add(3, 4))),
    print("repeat_string(\"ab\", 3) = " + repeat_string("ab", 3)),
    print("range_list(1, 5) = " + str(range_list(1, 5))),
    print("is_even(4) = " + str(is_even(4))),
    print("sum_of_squares(3, 4) = " + str(sum_of_squares(3, 4))),
    print("factorial(5) = " + str(factorial(5))),
    print("fizzbuzz(15) = " + fizzbuzz(15)),
    print("apply_twice(square, 2) = " + str(apply_twice(x -> x * x, 2)))
)
