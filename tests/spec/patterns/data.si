// Spec: patterns/data - test data patterns (map, filter, fold)
// Reference: docs/sigil_lang/0.1-alpha/spec/10-patterns.md

@test_map_pattern () -> void = run(
    let nums = [1, 2, 3],
    let doubled = map(.over: nums, .transform: x -> x * 2),
    assert_eq(len(doubled), 3)
)

@test_filter_pattern () -> void = run(
    let nums = [1, 2, 3, 4, 5],
    let evens = filter(.over: nums, .predicate: x -> x % 2 == 0),
    assert_eq(len(evens), 2)
)

@test_fold_pattern () -> void = run(
    let nums = [1, 2, 3, 4, 5],
    let sum = fold(.over: nums, .init: 0, .op: (acc, x) -> acc + x),
    assert_eq(sum, 15)
)

@test_combined_patterns () -> void = run(
    let nums = [1, 2, 3, 4, 5],
    let doubled = map(.over: nums, .transform: x -> x * 2),
    let filtered = filter(.over: doubled, .predicate: x -> x > 5),
    let sum = fold(.over: filtered, .init: 0, .op: (acc, x) -> acc + x),
    assert_eq(sum, 24)
)
