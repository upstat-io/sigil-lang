// Spec: 08-declarations.md § Trait Resolution — Method Priority
// Tests that inherent methods take priority over trait methods.

use std.testing { assert_eq }

trait Formatter {
    @format (self) -> str
}

type Item = { name: str }

// Inherent method
impl Item {
    @format (self) -> str = "inherent:" + self.name;
}

// Trait method with same name
impl Formatter for Item {
    @format (self) -> str = "trait:" + self.name;
}

// Inherent method should win over trait method
@test_inherent_over_trait tests @format () -> void = {
    let item = Item { name: "test" };
    assert_eq(actual: item.format(), expected: "inherent:test")
}

// Single trait method resolves unambiguously
trait Displayable {
    @display (self) -> str
}

type Widget = { label: str }

impl Displayable for Widget {
    @display (self) -> str = "widget:" + self.label;
}

@test_single_trait_unambiguous tests @display () -> void = {
    let w = Widget { label: "btn" };
    assert_eq(actual: w.display(), expected: "widget:btn")
}
