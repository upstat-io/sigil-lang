// Spec: spec/13-testing.md ยง Test Execution
// Design: design/11-testing/index.md ยง Overview
//
// Tests for the --filter option.
// Run with: sigil test tests/spec/tooling/test_filter.si --filter=auth
// to run only auth-related tests.

// =============================================================================
// Helper functions
// =============================================================================

@validate_auth (token: str) -> bool = token == "valid"

@validate_input (s: str) -> bool = s != ""

@compute_hash (x: int) -> int = x * 31

// =============================================================================
// Auth-related tests (filterable with --filter=auth)
// =============================================================================
@test_auth_valid tests @validate_auth () -> void = run(
    assert_eq(validate_auth("valid"), true),
)

@test_auth_invalid tests @validate_auth () -> void = run(
    assert_eq(validate_auth("invalid"), false),
    assert_eq(validate_auth(""), false),
)

// =============================================================================
// Input validation tests (filterable with --filter=input)
// =============================================================================
@test_input_nonempty tests @validate_input () -> void = run(
    assert_eq(validate_input("hello"), true),
    assert_eq(validate_input("x"), true),
)

@test_input_empty tests @validate_input () -> void = run(
    assert_eq(validate_input(""), false),
)

// =============================================================================
// Hash tests (filterable with --filter=hash)
// =============================================================================
@test_hash_basic tests @compute_hash () -> void = run(
    assert_eq(compute_hash(0), 0),
    assert_eq(compute_hash(1), 31),
    assert_eq(compute_hash(2), 62),
)
