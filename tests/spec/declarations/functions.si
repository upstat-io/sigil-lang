// Spec: 08-declarations.md ยง Function Declarations
// Design: 03-type-system/05-type-inference.md

use std.testing { assert, assert_eq, assert_ne }

// =============================================================================
// Function Parameter Type Annotations
// =============================================================================

@test_typed_param tests @typed_param () -> void = run(
    let result = typed_param(5),
    assert_eq(
        actual: result,
        expected: 10,
    ),
)

@typed_param (x: int) -> int = x * 2

@test_multiple_typed_params tests @multiple_typed_params () -> void = run(
    let result = multiple_typed_params(
        a: 3,
        b: 4,
    ),
    assert_eq(
        actual: result,
        expected: 7,
    ),
)

@multiple_typed_params (a: int, b: int) -> int = a + b

@test_mixed_types tests @mixed_types () -> void = run(
    let result = mixed_types(
        x: 5,
        y: 2.5,
    ),
    assert(cond: result > 7.0),
    assert(cond: result < 8.0),
)

@mixed_types (x: int, y: float) -> float = float(x) + y

// =============================================================================
// Function Return Type Annotations
// =============================================================================

@test_explicit_return_int tests @explicit_return_int () -> void = run(
    let result = explicit_return_int(),
    assert_eq(
        actual: result,
        expected: 42,
    ),
)

@explicit_return_int () -> int = 42

@test_explicit_return_str tests @explicit_return_str () -> void = run(
    let result = explicit_return_str(),
    assert_eq(
        actual: result,
        expected: "hello",
    ),
)

@explicit_return_str () -> str = "hello"

@test_explicit_return_bool tests @explicit_return_bool () -> void = run(
    let result = explicit_return_bool(),
    assert(cond: result),
)

@explicit_return_bool () -> bool = true

@test_explicit_return_void tests @explicit_return_void () -> void = run(
    explicit_return_void(),
    assert(cond: true),
)

@explicit_return_void () -> void = ()

// =============================================================================
// Full Function Signatures
// =============================================================================

@test_full_signature tests @full_signature () -> void = run(
    let result = full_signature(
        n: 10,
        prefix: "hello",
    ),
    assert_eq(
        actual: result,
        expected: "hello: 10",
    ),
)

@full_signature (n: int, prefix: str) -> str = prefix + ": " + str(n)
